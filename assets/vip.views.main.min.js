var uiViewsCurrentID;function uiViewsMenuSetup(){$("#mnuMenuViews").empty(),$dataViews.children().length>0&&($dataViews.find("view").each((function(){var mnuNode=$('<input type="radio" name="btnViews" id="btnView_'+$(this).index()+'" /><label id="lblView_'+$(this).index()+'" for="btnView_'+$(this).index()+'" title="Options">'+$(this).attr("displayname")+"</label>");$(mnuNode,"input").on("change",uiViewsMenuSelect),$("#mnuMenuViews").append(mnuNode)})),$("#mnuMenuViews").trigger("create"))}function uiViewsMenuSelect(e){if(uiDropdownCloseOthers(),this&&$(this).attr("id")){var viewIndex=$(this).attr("id").split("_")[1];viewShow($($dataViews.find("view")[viewIndex]).attr("id")),uiFeaturesMenuSetup(viewIndex),optionsShow(viewIndex)}}function viewShow(viewID){dbg("viewShow(viewID) "+viewID),uiViewsCurrentID=viewID;var $viewNode=$dataViews.find("view[id="+viewID+"]"),viewType=$viewNode.attr("type"),viewLegendID=$viewNode.attr("legendid"),$iframeExternal=$("#iframeExternalViewer"),$divImgs=$("#divImgs"),$layoutOptions=$("#layoutOptions"),$layoutFurniture=$("#layoutFurniture"),$layoutComponents=$("#layoutComponents"),$layoutOptionsImgs=$("#layoutOptionsImgs"),$divPlan=$("#divPlan"),$layoutPreview=$("#layoutPreview"),$sliderZoom=$("#btnZoomSlider"),$btnZoomAll=$("#btnZoomAll"),$btnZoomIn=$("#btnZoomIn"),$btnZoomOut=$("#btnZoomOut"),$btnFlipV=$("#btnFlipV"),$btnNoteTool=$("#btnNoteTool"),$btnLineTool=$("#btnLineTool");uiDropdownClose($("#btnLegend")),"file"===viewType||"url"===viewType?(isSmallScreen()||$layoutPreview.slideDown(),$sliderZoom.slider("disable"),$btnZoomAll.addClass("ui-disabled"),$btnZoomIn.addClass("ui-disabled"),$btnZoomOut.addClass("ui-disabled"),$btnFlipV.addClass("ui-disabled"),$btnNoteTool.addClass("ui-disabled"),$btnLineTool.addClass("ui-disabled"),$divPlan.css("visibility","hidden"),$divImgs.fadeOut(),$divImgs.empty(),$iframeExternal.attr("src",$viewNode.attr("path")),$iframeExternal.fadeIn(),$layoutOptions.fadeOut(),$layoutComponents.fadeOut(),$layoutFurniture.fadeOut(),$layoutOptionsImgs.fadeOut()):"imgs"===viewType||"ext"===viewType||"vis"===viewType?(isSmallScreen()||$layoutPreview.slideUp(),$sliderZoom.slider("disable"),$btnZoomAll.addClass("ui-disabled"),$btnZoomIn.addClass("ui-disabled"),$btnZoomOut.addClass("ui-disabled"),$btnFlipV.addClass("ui-disabled"),$btnNoteTool.addClass("ui-disabled"),$btnLineTool.addClass("ui-disabled"),$divPlan.css("visibility","hidden"),$divImgs.fadeIn(),$iframeExternal.fadeOut(),$iframeExternal.attr("src",""),$layoutOptions.fadeOut(),$layoutComponents.fadeOut(),$layoutFurniture.fadeOut(),$layoutOptionsImgs.fadeTo(EFFECT_SPEED_FADE_IN,1,(function(){$(this).css("display","flex")})),setTimeout("collapsibleSetIfp_Create($('#layoutAccordion'), $('#layoutOptionsImgs'));",250)):"svg"===viewType&&(isSmallScreen()||$layoutPreview.slideDown(),$sliderZoom.slider("enable"),$btnZoomAll.removeClass("ui-disabled"),$btnZoomIn.removeClass("ui-disabled"),$btnZoomOut.removeClass("ui-disabled"),$btnFlipV.removeClass("ui-disabled"),$btnNoteTool.removeClass("ui-disabled"),$btnLineTool.removeClass("ui-disabled"),$divPlan.css("visibility","visible"),VIP.Views.Renderer.renderToStage(viewID,!1,!1),$divImgs.fadeOut(),$divImgs.empty(),$iframeExternal.fadeOut(),$iframeExternal.attr("src",""),$layoutOptionsImgs.fadeOut(),$dataOptions.find('group[viewid="'+viewID+'"][typecode!="poi"]').find('option[visible="1"]').length||viewLegendID?$layoutOptions.fadeTo(EFFECT_SPEED_FADE_IN,1,(function(){$(this).css("display","flex")})):$layoutOptions.hide(),$dataComponents&&$dataComponents.find('group[type="component"]').find("component").length?$layoutComponents.fadeTo(EFFECT_SPEED_FADE_IN,1,(function(){$(this).css("display","flex")})):$layoutComponents.hide(),$dataComponents&&$dataComponents.find('group[type="furniture"]').find("component").length?$layoutFurniture.fadeTo(EFFECT_SPEED_FADE_IN,1,(function(){$(this).css("display","flex")})):$layoutFurniture.hide(),setTimeout("collapsibleSetIfp_Create($('#layoutAccordion'));",250)),viewLegendID?viewsLegendSetup(viewLegendID):viewsLegendPricingSetup(),uiViewMsgClear(void 0,!0);var viewMsgSubject=$.trim($viewNode.attr("msgsubject"));if(viewMsgSubject){var viewMsgDetail=$.trim($viewNode.attr("msgdetail")),viewMsgDismissible="true"===$viewNode.attr("msgisuserdismissible")||"1"===$viewNode.attr("msgisuserdismissible"),viewMsgCollapsible="true"===$viewNode.attr("msgisusercollapsible")||"1"===$viewNode.attr("msgisusercollapsible"),viewMsgDismissMs=$viewNode.attr("msgautodismissms");if("true"!==viewMsgDismissMs){var viewMsgDismissState=!(parseInt(viewMsgDismissMs,10)>0)||viewMsgDismissMs,viewMsgStartExpanded="true"===$viewNode.attr("msgisstartexpanded")||"1"===$viewNode.attr("msgisstartexpanded"),viewMsgCollapseMs=parseInt($viewNode.attr("msgautocollapsems"),10);uiViewMsg(viewID,viewMsgSubject,viewMsgDetail,viewMsgDismissState,viewMsgDismissible,!!viewMsgStartExpanded&&(viewMsgCollapseMs||viewMsgStartExpanded),viewMsgCollapsible)}}}function viewImgsFlip(reverse){var $imgPreview=$("#imgPreview"),$divImgs=$("#divImgs"),$divImgsItems=$divImgs.find(">*:not(.imgs-vis-wrapper)"),$ulImgsItems=$("#ulOpts_Imgs").find(".imgs-thumb");reverse?($imgPreview.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$imgPreview.css("transform","scale(-1,1)"),$imgPreview.fadeTo(EFFECT_SPEED_FADE_IN,1)})),0===$divImgsItems.length?$divImgs.addClass("flipped"):$divImgsItems.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$divImgs.addClass("flipped"),$divImgsItems.fadeTo(EFFECT_SPEED_FADE_IN,1)})),$ulImgsItems.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$(this).css("transform","scale(-1,1)").fadeTo(EFFECT_SPEED_FADE_IN,1)}))):($imgPreview.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$imgPreview.css("transform",""),$imgPreview.fadeTo(EFFECT_SPEED_FADE_IN,1)})),0===$divImgsItems.length?$divImgs.removeClass("flipped"):$divImgsItems.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$divImgs.removeClass("flipped"),$divImgsItems.fadeTo(EFFECT_SPEED_FADE_IN,1)})),$ulImgsItems.fadeTo(EFFECT_SPEED_FADE_OUT,0,(function(){$(this).css("transform","").fadeTo(EFFECT_SPEED_FADE_IN,1)})))}function viewsLegendSetup(legendID){dbg("viewsLegendSetup(legendID) "+legendID);var $divLegend=$("#divLegend"),fStatus=$.deparam.querystring().fstatus;if(!(!Site.Data.Main.$dataLegends||Site.Data.Main.$dataLegends.length<=0||fStatus>0)){var $legenditemNode,$legendNode=Site.Data.Main.$dataLegends.find("legend[id="+legendID+"]"),$svgSwatch=$("#divLegendSwatch").clone(!1,!1).attr("id",""),$divLegendLine=$('<h4><div class="prefix">'+$svgSwatch.html()+'</div><span class="suffix"></span></h4>');$legendNode.find('legenditem[ishidden!="1"]').each((function(){$legenditemNode=$(this),$divLegendLine.find(".suffix").text($legenditemNode.attr("displayname")),$divLegendLine.find(".prefix>svg").children(0).attr("fill",$legenditemNode.attr("color1")),$divLegend.append($divLegendLine.clone(!1,!1))})),$("#layoutOptions > .ui-collapsible-heading .ui-btn-text").text("Legend");var $legendDiv=$("#layoutOptions > div");$legendDiv.empty(),$legendDiv.append($divLegend),$legendDiv.trigger("create"),$("#layoutAccordion .ui-collapsible-content .ui-collapsible-content").css("flex-flow","unset"),$("#divLegend").mCustomScrollbar({theme:"vip",axis:"y",scrollButtons:{enable:!0},autoDraggerLength:!1,scrollInertia:200,documentTouchScroll:!1})}}function viewsLegendPricingSetup(){if(dbg("viewsLegendPricingSetup() "),!$("#divMenuLegend").is(":visible")){var asShownText=$dataInfo.attr("clientoptionpricingasshowntext"),basePrice="";optionPricingIsEnabled()?void 0!==$dataInfo.attr("baseprice")&&"0.00"!==$dataInfo.attr("baseprice")&&(basePrice=$dataInfo.attr("baseprice")):asShownText=asShownText.charAt(0).toUpperCase()+asShownText.slice(1);var baseSqFt="";if(optionSquareFootageIsEnabled()&&(void 0===(baseSqFt=$dataInfo.attr("basesquarefootage"))||0==baseSqFt||isNaN(baseSqFt))&&(baseSqFt=""),""!=basePrice||""!=baseSqFt){""!=basePrice&&(basePrice=strFormatCurrency(basePrice,0)),""!=baseSqFt?(baseSqFt=parseFloat(baseSqFt).toFixed(0).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),baseSqFtText=baseSqFt+$dataInfo.attr("clientareatext")):(baseSqFt="",baseSqFtText=""),$("#btnLegendHandle").find(".ui-btn-text").text("Pricing");var $divLegend=$("#divLegend"),$tblPricing=$('<table id="tblLegendPricing"></table>');$('<tr class="base"><td>'+basePrice+"</td><td>Standard Plan</td><td align=right>"+baseSqFtText+"</td></tr>").appendTo($tblPricing),$('<tr class="total"><td>'+basePrice+"</td><td>"+asShownText+"</td><td align=right>"+baseSqFtText+"</td></tr>").hide().appendTo($tblPricing),$divLegend.empty().append($tblPricing),$("#spanPriceAsShownNumber").text(basePrice),$("#spanPriceAsShownText").text(" "+asShownText+" ");var prefix="";""!=basePrice&&""!=baseSqFt&&(prefix=" â€¢ "),$("#spanSqFtAsShownText").text(prefix+baseSqFtText),$("#divMenuLegend").show(),""==basePrice&&$("#tblLegendPricing tr td:nth-child(1)").css("width",0)}else $("#spanPriceAsShownText").text("")}}