function svgPlanOptionCreateLayerPlaceholders(viewID,$gContainer,putOptionsUnderView,attachEvents){$gContainer=$gContainer||$("#gPlan"),putOptionsUnderView=putOptionsUnderView||!1,attachEvents=attachEvents||!1;var $gPlaceholder,optionPlanDataSVGID,optionSVGID,$gOption,$gContainerTmp,isPoi,poiX,poiY,mxPoi,$divToolbox=$("#divSVGToolbox"),viewSVGID=$dataViews.find("view[id="+viewID+"]").attr("svgid"),viewDBID=strStripNonNumeric(viewID);$svgPlanData.find("g[id^="+strEscapeDots(viewSVGID+".opt")+"], g[id^="+strEscapeDots(viewSVGID+".poi")+"]").each((function(){$gContainerTmp=$gContainer,optionPlanDataSVGID=$(this).attr("id"),isPoi=-1!==optionPlanDataSVGID.indexOf(".poi."),(optionSVGID=optionPlanDataSVGID.substring(0,optionPlanDataSVGID.lastIndexOf(".")))!==viewSVGID+".opt"&&optionSVGID!==viewSVGID+".poi"&&optionSVGID!==viewSVGID||(optionSVGID=optionPlanDataSVGID),$dataOptions.find("group[viewid="+viewDBID+"]").find("option[data1="+strEscapeDots(optionSVGID)+"]").length>0&&($gPlaceholder=$divToolbox.find("g").clone(!1,!1).empty().attr("id",optionPlanDataSVGID),isPoi&&($gOption=$svgPlanData.find("g[id="+strEscapeDots(optionSVGID)+"]").children(0),poiX=parseFloat($gOption.attr("cx"))-50*OPTION_POI_SCALE,poiY=parseFloat($gOption.attr("cy"))-50*OPTION_POI_SCALE,mxPoi=xfrmSVGGet($gPlaceholder),mxPoi=xfrmMatrixMoveAbsolute(mxPoi,poiX,poiY),mxPoi=xfrmMatrixScaleAbsolute(mxPoi,OPTION_POI_SCALE,OPTION_POI_SCALE),xfrmSVGSet($gPlaceholder,mxPoi),$gOption.parents("g[id^="+strEscapeDots(viewSVGID+".opt")+"]").length>0&&($gContainerTmp=$gOption.parents("g[id^="+strEscapeDots(viewSVGID+".opt")+"]")).find("g[id="+strEscapeDots(optionPlanDataSVGID)+"]").remove()),!0===putOptionsUnderView?$gPlaceholder.prependTo($gContainerTmp):$gPlaceholder.appendTo($gContainerTmp),(isPoi||!0===attachEvents)&&(($gPlaceholder=$("#"+strEscapeDots(optionPlanDataSVGID))).css("cursor","pointer"),isTouchDevice()||($gPlaceholder.live("mouseenter",VIP.Options.Main.svgElOnMouseEnter),$gPlaceholder.live("mouseleave",VIP.Options.Main.svgElOnMouseLeave),$gPlaceholder.live("mousemove",VIP.Options.Main.svgElOnMouseMove)),$gPlaceholder.live("vmouseup",VIP.Options.Main.svgElOnMouseDown)))}))}function svgPlanOptionShowHide(optionID,show,viewID,$gContainer,reverseTextH,reverseTextV){$gContainer=$gContainer||$("#gPlan"),reverseTextH=void 0===reverseTextH?"true"===$dataInfo.attr("flippedh"):reverseTextH,reverseTextV=void 0===reverseTextV?"true"===$dataInfo.attr("flippedv"):reverseTextV;var $viewNode=$dataViews.find("view[id="+viewID+"]"),viewSVGID=$viewNode.attr("svgid"),featureSVGID="",$optionNode=$dataOptions.find("option[id="+optionID+"]"),optionSVGID=$optionNode.attr("data1");if(optionSVGID){var $gOptionNew,$gFeature,$gOptionOrFeatureTmp,poiIconSVGID,$gOption=$gContainer.find("g[id="+strEscapeDots(optionSVGID)+"]"),poiFeatureEnabled=1==$optionNode.attr("selected"),isPoi=-1!==optionSVGID.indexOf(".poi."),$divPoiIcons=$("#divPoiIcons");!0===show?0===optionSVGID.indexOf(viewSVGID)&&(isPoi?(poiIconSVGID=$optionNode.attr("data2"),$gOptionNew=$divPoiIcons.find("g[id="+strEscapeDots(poiIconSVGID)+"]").clone(!1,!1),$gOption.empty(),poiFeatureEnabled&&$gOption.append($gOptionNew)):(($gOptionNew=$svgPlanData.find("g[id="+strEscapeDots(optionSVGID)+"]").clone(!1,!1)).replaceAll($gOption),$viewNode.find("feature[selected=1]").each((function(){featureSVGID=optionSVGID+"."+$(this).attr("svgid"),$gFeature=$gContainer.find("g[id="+strEscapeDots(featureSVGID)+"]"),$svgPlanData.find("g[id="+strEscapeDots(featureSVGID)+"]").clone(!1,!1).replaceAll($gFeature)})),$gOptionNew.find("g[id*="+strEscapeDots(".poi.")+"]").each((function(){svgPlanOptionShowHide(optionID=$dataOptions.find("option[data1="+strEscapeDots($(this).attr("id"))+"]").attr("id"),!0,viewID,$gContainer,reverseTextH,reverseTextV)})),$gContainer.find("g[id="+strEscapeDots(optionSVGID)+"],[id^="+strEscapeDots(optionSVGID+".")+"]").each((function(){$gOptionOrFeatureTmp=$(this),svgPlanFlipOrientTextHelper($gOptionOrFeatureTmp,reverseTextH,reverseTextV),svgPlanFlipOrientPOIHelper($gOptionOrFeatureTmp,reverseTextH,reverseTextV),svgPlanOptionSetupColor($gOptionOrFeatureTmp)})))):$gContainer.find("g[id^="+strEscapeDots(optionSVGID)+"]").empty()}else dbg("BAD LOGIC CONFIG! "+optionID)}function svgPlanOptionSetupColor($optionEl){svgHighlight($optionEl,OPTION_COLOR_BASE,OPTION_COLOR_HOVER)}function svgPlanOptionHighlight(optionID,highlight){var $gPlan=$("#gPlan"),$optionNode=$dataOptions.find("option[id="+optionID+"]");if("poi"!=$optionNode.parent().attr("typecode")){var optionSVGID=$optionNode.attr("data1"),optionSelected="1"===$optionNode.attr("enabled")&&"1"===$optionNode.attr("selected"),$optionDOMElement=$gPlan.find("g[id="+strEscapeDots(optionSVGID)+"],[id^="+strEscapeDots(optionSVGID+".")+"]"),reverseTextH="true"===$dataInfo.attr("flippedh"),reverseTextV="true"===$dataInfo.attr("flippedv");highlight?(optionSelected||svgPlanOptionShowHide(optionID,!0,uiViewsCurrentID,$gPlan,reverseTextH,reverseTextV),svgHighlight($optionDOMElement,OPTION_COLOR,OPTION_COLOR_HOVER)):(svgHighlight($optionDOMElement,OPTION_COLOR_HOVER,OPTION_COLOR),optionSelected||svgPlanOptionShowHide(optionID,!1,uiViewsCurrentID,$gPlan,reverseTextH,reverseTextV))}}