function svgDropGetPlanScale(componentType,componentScaleXOverride,componentScaleYOverride){var scale={x:0,y:0};return void 0===componentScaleXOverride||void 0===componentScaleYOverride?"component"===componentType?scale.x=scale.y=parseFloat(dataCompScale):"furniture"===componentType&&(scale.x=scale.y=parseFloat(dataCompScaleFurniture)):(scale.x=parseFloat(componentScaleXOverride),scale.y=parseFloat(componentScaleYOverride)),scale}function svgDropGetSizeForPage(componentType,componentScaleXOverride,componentScaleYOverride){var size=svgDropGetSizeForPlan(componentType,componentScaleXOverride,componentScaleYOverride);return size.width*=svgPlanZoomFinalizedScale/svgPlanZoom100AbsoluteScale,size.height*=svgPlanZoomFinalizedScale/svgPlanZoom100AbsoluteScale,size}function svgDropGetSizeForPage2(componentType,compDimWidth,compDimHeight){var size={width:0,height:0},scale=svgDropGetPlanScale(componentType);return size.width=compDimWidth*COMP_LIBRARY_DIMENSION_SCALE*scale.x*(svgPlanZoomFinalizedScale/svgPlanZoom100AbsoluteScale),size.height=compDimHeight*COMP_LIBRARY_DIMENSION_SCALE*scale.y*(svgPlanZoomFinalizedScale/svgPlanZoom100AbsoluteScale),size}function svgDropGetSizeForPage3(compBBoxWidth,compBBoxHeight,compScaleX,compScaleY){var size={width:compBBoxWidth,height:compBBoxHeight};return size.width=size.width*compScaleX,size.height=size.height*compScaleY,size}function svgDropGetSizeForPlan(componentType,componentScaleXOverride,componentScaleYOverride){var size={width:0,height:0},scale=svgDropGetPlanScale(componentType,componentScaleXOverride,componentScaleYOverride);return"component"!==componentType&&"furniture"!==componentType||(size.width=COMP_ICON_WIDTH*scale.x,size.height=COMP_ICON_HEIGHT*scale.y),size}function svgDropGetCoordsForPage(planX,planY,componentType,componentScaleXOverride,componentScaleYOverride){planX=parseFloat(planX),planY=parseFloat(planY);var size=svgDropGetSizeForPlan(componentType,componentScaleXOverride,componentScaleYOverride);return planX+=size.width/2,planY+=size.height/2,svgPlanGetCoordsForPage(planX,planY)}function svgDropGetCoordsForPlan(pageX,pageY,componentType,componentScaleXOverride,componentScaleYOverride){pageX=parseFloat(pageX),pageY=parseFloat(pageY);var compPlanPos=svgPlanGetCoordsForPlan(pageX,pageY),size=svgDropGetSizeForPlan(componentType,componentScaleXOverride,componentScaleYOverride);return compPlanPos.x-=size.width/2,compPlanPos.y-=size.height/2,compPlanPos}function svgDropGetDropID($domElement){var dropID=$domElement.attr("id");return dropID&&(dropID=(dropID=dropID.split("_"))[2]),dropID}function svgDropGetDropNode($domElement){var dropID=svgDropGetDropID($domElement);return $dataViews.find("drop[dropid="+dropID+"]")}function svgDropOrient($domElement,planX,planY,radians,scaleX,scaleY,width,height,pageX,pageY){var $dropNode=svgDropGetDropNode($domElement),componentType=$dropNode.attr("type");"component"==componentType||"furniture"==componentType?(width=COMP_ICON_WIDTH,height=COMP_ICON_HEIGHT):null!=width&&null!=height||(width=0,height=0),scaleX=null==scaleX?1:parseFloat(scaleX),scaleY=null==scaleY?1:parseFloat(scaleY);var mx=xfrmMatrixGetDefault();if(null==planX&&null==planY)if(null!=pageX&&null!=pageY){var coordsPlan=svgPlanGetCoordsForPlan(pageX,pageY);planX=coordsPlan.x-width/2*scaleX,planY=coordsPlan.y-height/2*scaleY}else planX=0,planY=0;mx=xfrmMatrixMoveAbsolute(mx,planX,planY),mx=xfrmMatrixRotate(mx,radians,width/2*scaleX,height/2*scaleY);var scale=svgDropGetPlanScale(componentType,scaleX,scaleY);mx=xfrmMatrixScale(mx,scale.x,scale.y);var planFlippedH="true"===$dataInfo.attr("flippedh"),planFlippedV="true"===$dataInfo.attr("flippedv"),componentFlippedH="true"===$dropNode.attr("flippedh"),componentFlippedV="true"===$dropNode.attr("flippedv");mx=xfrmMatrixMirror(mx,planFlippedH&&!componentFlippedH||!planFlippedH&&componentFlippedH,planFlippedV&&!componentFlippedV||!planFlippedV&&componentFlippedV,width,height),xfrmSVGSet($domElement,mx)}function svgDropSelect(){var $elComponent=$(this),dropID=svgDropGetDropID($elComponent);componentSelect($elComponent,dropID)}function svgDropDelete($domElement){$domElement.remove()}function svgDropSave($domElement){}function svgDropUpdateProperties($domElement,txt){var componentType=svgDropGetDropNode($domElement).attr("type"),$divToolbox=$("#divSVGToolbox");if("note"===componentType){$domElement.empty();var $elText=$divToolbox.find("text").clone(!1,!1).empty();txt=txt.split(/\r\n|\r|\n/g);for(var i=0;i<txt.length;i++)$divToolbox.find("tspan").clone(!1,!1).empty().text(txt[i]).attr("x",0).attr("y",17*(i+1)).appendTo($elText);$elText.appendTo($domElement)}}function svgDropCreateComponent($componentSVG,viewID,componentID,componentDropID,planX,planY,radians,scaleX,scaleY,interactive,forceTop,forceBottom){var $gComponent=$componentSVG.find(">g").clone(!1),dropPlanID="comp_"+componentID+"_"+componentDropID;$gComponent.attr("id",dropPlanID),$gComponent.attr("class","ui-clickable"),svgDropOrient($gComponent,planX,planY,radians,scaleX,scaleY,void 0,void 0,void 0,void 0),isSmallScreen()||setTimeout("$('#"+dropPlanID+"').on('tap', svgDropSelect);",500);var $gDropsHolder=$("#comps_"+viewID);forceTop?$gDropsHolder=$("#comps_"+viewID+"_top"):forceBottom&&($gDropsHolder=$("#comps_"+viewID+"_bottom")),$gComponent.appendTo($gDropsHolder),interactive&&componentSelect($gComponent,componentDropID)}function svgDropCreateNote(txt,viewID,dropID,planX,planY,radians,interactive){var $divToolbox=$("#divSVGToolbox"),$gDrop=$divToolbox.find("g").clone(!1,!1).empty(),$svgText=$divToolbox.find("text").clone(!1,!1).empty();txt=txt.split(/\r\n|\r|\n/g);for(var i=0;i<txt.length;i++)$divToolbox.find("tspan").clone(!1,!1).empty().text(txt[i]).attr("x",0).attr("y",14*(i+1)).appendTo($svgText);$svgText.appendTo($gDrop);var dropPlanID="comp_note_"+dropID;$gDrop.attr("id",dropPlanID),$gDrop.attr("class","note ui-clickable"),svgDropOrient($gDrop,planX,planY,radians,void 0,void 0,void 0,void 0,void 0,void 0),setTimeout("$('#"+dropPlanID+"').on('tap', svgDropSelect);",500);var $gDropsHolder=$("#comps_"+viewID+"_top");$gDrop.appendTo($gDropsHolder),interactive&&componentSelect($gDrop,dropID)}function svgDropCreateLine(viewID,dropID,positionPlan,radians,interactive){var $divToolbox=$("#divSVGToolbox"),$gDrop=$divToolbox.find("g").clone(!1,!1).empty(),$svgLine=$divToolbox.find("line").clone(!1,!1).empty();$svgLine.attr("x1",positionPlan.x1),$svgLine.attr("y1",positionPlan.y1),$svgLine.attr("x2",positionPlan.x2),$svgLine.attr("y2",positionPlan.y2),$svgLine.attr("stroke","#ffffff"),$svgLine.attr("stroke-width","10"),$svgLine.css("opacity",.1),$svgLine.appendTo($gDrop),($svgLine=$svgLine.clone(!1,!1)).attr("stroke","#000000"),$svgLine.attr("stroke-width","1"),$svgLine.css("opacity",""),$svgLine.appendTo($gDrop);var dropPlanID="comp_line_"+dropID;$gDrop.attr("id",dropPlanID),$gDrop.attr("class","ui-clickable"),setTimeout("$('#"+dropPlanID+"').on('tap', svgDropSelect);",500);var $gDropsHolder=$("#comps_"+viewID+"_top");$gDrop.appendTo($gDropsHolder),interactive&&componentSelect($gDrop,dropID)}