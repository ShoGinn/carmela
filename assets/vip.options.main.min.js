window.VIP=window.VIP||{},window.VIP.Options=window.VIP.Options||{},window.VIP.Options.Main=function($,undefined){var self={};self.svgElOnMouseEnter=function(e){var $svgOptionEl=$(this);svgHighlight($svgOptionEl,POI_COLOR,POI_COLOR_HOVER)},self.svgElOnMouseLeave=function(e){var $svgOptionEl=$(this);svgHighlight($svgOptionEl,POI_COLOR_HOVER,POI_COLOR)},self.svgElOnMouseMove=function(e){},self.svgElOnMouseDown=function(e){optionsPoiShow($(this).attr("id"))};return self}(jQuery);var optionsSetupInitiallySelected,optionsLogicDbgIndent,optionsLogicProcessOption_ProcessedItems,optionsLogicIsInitRun,$optionsPricingRecentFadeItem,optionsPricingRecentFadeTimeout,optionsVizCurrentlyHighlighted,optionsVizCurrentlySelected,$rowPrevious,OPTION_COLOR_BASE="#000000",OPTION_COLOR="#000099",OPTION_COLOR_HOVER="#cc0000",OPTION_COLOR_NOTFEATURED="#666666",OPTION_LOGIC_TYPE_MUTEX={flag:2,id:1,code:"mutex"},OPTION_LOGIC_TYPE_GROUP={flag:4,id:2,code:"group"},OPTION_LOGIC_TYPE_PARENTCHILD={flag:8,id:3,code:"parentchild"},OPTION_LOGIC_TYPE_PARENTHIDDENCHILD={flag:16,id:4,code:"parenthiddenchild"},OPTION_POI_SCALE=.2,OPTION_POI_WIDTH=100,OPTION_POI_HEIGHT=100,POI_COLOR_BASE="#000000",POI_COLOR="#000099",POI_COLOR_HOVER="#0000ff",OPTION_POI_TEMPLATE_IFRAME='<iframe id="divDialogPoiIFrame" src="" width="100%" height="100%" frameborder="0" marginheight="0" marginwidth="0" align="middle" seamless></iframe>',OPTION_POI_TEMPLATE_IMG='<img id="divDialogPoiImg" src="" />',OPTION_POI_TEMPLATE_HTML='<div id="divDialogPoiHtml" />';function optionsSetup(){}function optionsSetupAfterData(){"1"===$dataInfo.attr("clientlogicforceparenthiddenchild")&&(OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code=OPTION_LOGIC_TYPE_PARENTCHILD.code);var poiScale=$dataInfo.attr("poiscale");poiScale&&!isNaN(poiScale)&&(OPTION_POI_SCALE=poiScale),optionsPoiLoadIcons(),setTimeout(optionsImgsPreload,750)}function optionsShow(floorIndex){dbg("optionsShow(floorIndex) "+floorIndex);var viewID=$($dataViews.find("view")[floorIndex]).attr("id"),viewDBID=strStripNonNumeric(viewID),viewType=$dataViews.find("view[id="+viewID+"]").attr("type");if("imgs"!==viewType&&"ext"!==viewType)if("vis"!==viewType){var $optGroupXMLNode,optGroupDisplayName,optGroupTypeCode,$optXMLNode,$optGroup,$input,$label,optID,optDisplayName,$logicNode,parentOptionID,childOptionIDList,$optsDiv=$("#layoutOptions > div");$optsDiv.empty(),$dataOptions.find('group[viewid="'+viewDBID+'"]').each((function(){$optGroupXMLNode=$(this),optGroupDisplayName=$optGroupXMLNode.attr("displayname"),"poi"!==(optGroupTypeCode=$optGroupXMLNode.attr("typecode"))&&($optsList=$('<div data-role="collapsible" data-inset="false" data-mini="true" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d" data-iconpos="right"><h3>'+optGroupDisplayName+"</h3></div>")),$optGroup=$('<fieldset data-role="controlgroup" data-mini="true"></fieldset>'),$optGroupXMLNode.find("option").each((function(){$optXMLNode=$(this),optID=$optXMLNode.attr("id"),optDisplayName=$optXMLNode.attr("displayname"),$input=$('<input type="checkbox" id="btnOption_'+optID+'"/>'),$label=$('<label id="lblOption_'+optID+'" for="btnOption_'+optID+'">'+optDisplayName+"</label>"),$input.on("change",uiOptionSelect),isTouchDevice()||($label.on("mouseenter",uiOptionOnMouseEnter),$label.on("mouseleave",uiOptionOnMouseLeave)),$optGroup.append($input),$optGroup.append($label),"poi"===optGroupTypeCode&&($input.attr("checked","checked"),$label.trigger("mouseenter"))})),$optGroup.find("label").on("vmousedown",(function(e){if(!isTouchDevice())return killEvent(e)})),$optGroup.find("label").on("vmouseover",(function(e){if(!isTouchDevice())return killEvent(e)})),"poi"!==optGroupTypeCode&&($optsList.append($optGroup),$optsDiv.append($optsList))})),$optsDiv.trigger("create"),$("#layoutOptions .ui-collapsible-content").children().hide(),$dataOptionsLogic.find('logic[type="'+OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code+'"]').each((function(){$logicNode=$(this),parentOptionID="o-"+strStripNonNumeric($logicNode.attr("optionids")),$("#btnOption_"+parentOptionID).parent().addClass("ui-opt-parenthiddenchild-parent"),childOptionIDList=(childOptionIDList=(childOptionIDList=$logicNode.attr("childoptionids")).replace(/^,|,$/g,"")).split(","),$.each(childOptionIDList,(function(key,val){$("#btnOption_"+("o-"+val)).parent().addClass("ui-opt-parenthiddenchild-child")}))})),optionsLogicInitialize(viewID),$dataOptions.find('group[viewid="'+viewDBID+'"][typecode!="poi"]').find('option[visible="1"]').length?$("#layoutOptions").show({complete:function(){$(this).css("display","flex")}}):$("#layoutOptions").hide(),$("#layoutOptions").addClass("ui-loading")}else optionsVizShow(floorIndex);else optionsImgsShow(floorIndex)}function optionsAnalyticsTrackEvent(optionID,selected){var optGAAction="option_select";selected||(optGAAction="option_deselect");var $optionNode=$dataOptions.find("option[id="+optionID+"]"),$optionGroupNode=$optionNode.parent(),optGroupViewID="v-"+$optionGroupNode.attr("viewid"),$optionGroupViewNode=$dataViews.find("view[id="+optGroupViewID+"]");vip_gtag(optGAAction,$optionGroupViewNode.attr("displayname")+" > "+$optionGroupNode.attr("displayname"),$optionNode.attr("displayname"),$optionGroupViewNode.attr("clientsuid"))}function uiOptionOnMouseEnter(){if(this&&$(this).attr("for")){var optionID=$(this).attr("for").split("_");optionID=optionID[1],svgPlanOptionHighlight(optionID,!0)}return killEvent()}function uiOptionOnMouseLeave(){if(this&&$(this).attr("for")){var optionID=$(this).attr("for").split("_");optionID=optionID[1],svgPlanOptionHighlight(optionID,!1)}return killEvent()}function uiOptionSelect(){var $option=$(this),visible=$option.is(":visible"),enabled=!$option.is(":disabled"),selected=$option.is(":checked"),optionID=$option.attr("id").split("_");optionsUpdateState(optionID=optionID[1],visible,enabled,selected),optionsUpdateUI(optionID),optionsLogicProcessOption(optionID),optionPricingRefresh(!0),optionsAnalyticsTrackEvent(optionID,selected)}function optionsPoiLoadIcons(){$("#divPoiIcons").find("g[id^=poi]").each((function(){svgHighlight($(this),POI_COLOR_BASE,POI_COLOR)}))}function optionsPoiShow(poiSvgID){var $optXMLNode=$dataOptions.find('option[data1="'+strEscapeDots(poiSvgID)+'"]');$optXMLNode.length||($optXMLNode=$dataOptions.find('option[id="'+strEscapeDots(poiSvgID)+'"]'));var optTypeCode=$optXMLNode.attr("typecode"),optText1=$optXMLNode.find("text1").text();optText1||(optText1=$optXMLNode.attr("text1")),"img"===optTypeCode?optionsPoiShow_Img(optText1):"url"===optTypeCode?optionsPoiShow_URL(optText1):"htm"===optTypeCode&&optionsPoiShow_HTML(optText1)}function optionsPoiShow_HTML(html){$("#divDialogPOI").empty().addClass("ui-loading");var $divDialogPoiHtml=$(OPTION_POI_TEMPLATE_HTML);if($divDialogPoiHtml.append(html),$("#divDialogPOI").append($divDialogPoiHtml),$("#layoutDialogPOI").popup("open"),$("#divDialogPOI").removeClass("ui-loading"),isSmallScreen()){var $scrollContainer=$("#divDialogPOI").find(".ui-scroll-container");$scrollContainer.length&&($scrollContainer.mCustomScrollbar("stop"),$scrollContainer.mCustomScrollbar("destroy"),$scrollContainer.mCustomScrollbar({theme:"vip",axis:"y",scrollButtons:{enable:!0},autoDraggerLength:!1,scrollInertia:200,documentTouchScroll:!1,updateOnContentResize:!0}))}}function optionsPoiShow_URL(url){$("#divDialogPOI").empty().addClass("ui-loading");var $divDialogPoiIFrame=$(OPTION_POI_TEMPLATE_IFRAME);$divDialogPoiIFrame.attr("src",url),$divDialogPoiIFrame.on("load",(function(){$("#divDialogPOI").removeClass("ui-loading")})),$("#divDialogPOI").append($divDialogPoiIFrame),$("#layoutDialogPOI").popup("open")}function optionsPoiShow_Img(url){$("#divDialogPOI").empty().addClass("ui-loading");var $divDialogPoiImg=$(OPTION_POI_TEMPLATE_IMG);$divDialogPoiImg.css("visibility","hidden"),$divDialogPoiImg.attr("src",url),$divDialogPoiImg.on("load",(function(){var $imgLoaded=$(this),imgH=$imgLoaded.height();imgH=imgH/2*-1,$imgLoaded.css("margin-top",imgH).css("top","50%").css("position","relative"),$("#divDialogPOI").removeClass("ui-loading"),$imgLoaded.css("visibility","visible")})),$("#divDialogPOI").append($divDialogPoiImg),$("#layoutDialogPOI").popup("open")}function optionsPoiShow_Video(url){}function optionsVizShow(floorIndex){var $divVisImgWrapper,$divImgWrapper,$divImgs=$("#divImgs");$divImgs.empty();var $input,$label,$img,labelId,$optsList,$optGroup,$optSub,$optCat,$optFin,optSubId,optSubDisplayName,optSubDisabled,optSubChecked,optSubThumbPath,optSubImgPath,optCatId,optCatDbId,optCatDisplayName,optCatDisabled,optCatChecked,optFinId,optFinDisplayName,optFinDisabled,optFinChecked,optFinColor,optId,$opt,optOptionsList,optColor,$view=$($dataViews.find("view")[floorIndex]),viewID=$view.attr("id"),viewDBID=strStripNonNumeric(viewID),viewDisplayName=$view.attr("displayname"),isFlippedH="true"===$dataInfo.attr("flippedh"),$optsDiv=$("#layoutOptionsImgs");$optsDiv.empty(),$optsList=$('<div data-role="collapsible" data-inset="false" data-mini="true" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d" data-iconpos="right"><h3>'+viewDisplayName+"</h3></div>"),($optGroup=$('<fieldset data-role="controlgroup" data-mini="true"></fieldset>')).find("label").on("vmousedown",(function(e){if(!isTouchDevice())return killEvent(e)})),$optGroup.find("label").on("vmouseover",(function(e){if(!isTouchDevice())return killEvent(e)})),$dataOptions.find("group[viewid="+viewDBID+"]").each((function(){$optSub=$(this),optSubId=$optSub.attr("id"),strStripNonNumeric(optSubId),$optSub.attr("typecode"),optSubDisplayName=$optSub.attr("displayname"),optSubDisabled="0"===$optSub.attr("enabled")?'disabled="disabled"':"",optSubChecked="1"===$optSub.attr("selected")?'checked="checked"':"",$optSub.attr("filespath"),optSubThumbPath=$optSub.attr("thumbnailimagepath"),($input=$('<input type="radio" name="btnOptionGroup_'+viewID+'" id="btnOptionCat_'+optSubId+'" '+optSubDisabled+" "+optSubChecked+" />")).on("change",optionsVizSelect),$label=$('<label id="lblOptionCat_'+optSubId+'" for="btnOptionCat_'+optSubId+'"><br/>'+optSubDisplayName+"</label>"),$img=$('<img class="imgs-thumb" width="234" src="'+optSubThumbPath+'"/>'),isFlippedH&&$img.css("transform","scale(-1,1)"),$img.imgRetina({new_base_src:optSubThumbPath}),$label.prepend($img),$label.prepend($('<div class="ui-radio-btnoverlay">Explore Options</div>')),$optSub=$dataOptions.find("group[id="+optSubId+"]"),optSubImgPath=$optSub.attr("fullsizeimagepath"),($divVisImgWrapper=$divImgs.find("div.imgs-vis-wrapper[data-for="+optSubId+"]")).length||($divVisImgWrapper=$('<div class="imgs-vis-wrapper" data-for="'+optSubId+'"></div>'),($divImgWrapper=$('<div class="imgs-wrapper"><img class="imgs-img" /><div class="imgs-txt"></div></div>')).find(".imgs-img").attr("src",optSubImgPath),$divImgWrapper.appendTo($divVisImgWrapper),$divImgWrapper.css("opacity","1"),$divVisImgWrapper.appendTo($divImgs)),$optGroup.append($input),$optGroup.append($label),$optSub.find("option[typecode=visscheme]").length?$optSub.find("option[typecode=visscheme]").each((function(){$optCat=$(this),optCatId=$optCat.attr("id"),optCatDbId=strStripNonNumeric(optCatId),optCatDisplayName=$optCat.attr("displayname"),optCatDisabled="0"===$optCat.attr("enabled")?'disabled="disabled"':"",optCatChecked="1"===$optCat.attr("selected")?'checked="checked"':"",optCatOptionsList=$optCat.attr("data1"),($input=$('<input type="checkbox" id="btnOption_'+optCatId+'" data-parent="btnOptionCat_'+optSubId+'" '+optCatDisabled+" "+optCatChecked+" />")).on("change",uiOptionSelect),$label=$('<label id="lblOption_'+optCatId+'" for="btnOption_'+optCatId+'" data-parent="btnOptionCat_'+optSubId+'">'+optCatDisplayName+"</label>"),$input.addClass("ui-opt-scheme"),$label.addClass("ui-opt-scheme"),$label.on("vmousedown",(function(e){var labelId=$(this).attr("id"),inputId=labelId.replace("lbl","btn"),$inputEl=$("#"+inputId),inputParentId=$inputEl.attr("data-parent");$inputEl.attr("checked")?optionsVizCurrentlySelected=void 0:(optionsVizCurrentlySelected=labelId,$('input[data-parent="'+inputParentId+'"]').each((function(){$(this).attr("id")!=labelId&&$(this).attr("checked")?$(this).attr("checked",!1).checkboxradio("refresh").trigger("change"):$(this).trigger("change")})))})),$optGroup.append($input),$optGroup.append($label)})):$optSub.find("option[typecode=viscategory]").each((function(){$optCat=$(this),optCatId=$optCat.attr("id"),optCatDbId=strStripNonNumeric(optCatId),optCatDisplayName=$optCat.attr("displayname"),optCatDisabled="0"===$optCat.attr("enabled")?'disabled="disabled"':"",optCatChecked="1"===$optCat.attr("selected")?'checked="checked"':"",$optCat.attr("data1"),$input=$('<input type="checkbox" id="btnOption_'+optCatId+'" data-parent="btnOptionCat_'+optSubId+'" '+optCatDisabled+" "+optCatDisabled+" />"),$label=$('<label id="lblOption_'+optCatId+'" for="btnOption_'+optCatId+'" data-parent="btnOptionCat_'+optSubId+'">'+optCatDisplayName+"</label>"),$input.addClass("ui-opt-parenthiddenchild-parent"),$label.addClass("ui-opt-parenthiddenchild-parent"),$input.on("change",(function(){$(this).attr("checked")?$('label[data-parent="'+$(this).attr("id")+'"]').parent().slideDown():$('label[data-parent="'+$(this).attr("id")+'"]').parent().slideUp()})),$optGroup.append($input),$optGroup.append($label),$optSub.find("option[typecode=visfinish][parentoptionid="+optCatDbId+"]").each((function(){$optFin=$(this),optFinId=$optFin.attr("id"),optFinDisplayName=$optFin.attr("displayname"),optFinDisabled="0"===$optFin.attr("enabled")?'disabled="disabled"':"",optFinChecked="1"===$optFin.attr("selected")?'checked="checked"':"",$optFin.attr("data1"),optFinColor=$optFin.attr("data2"),($input=$('<input type="checkbox" id="btnOption_'+optFinId+'" data-parent="btnOption_'+optCatId+'" '+optFinChecked+" "+optFinDisabled+"/>")).on("change",uiOptionSelect),$label=$('<label id="lblOption_'+optFinId+'" for="btnOption_'+optFinId+'" data-parent="btnOption_'+optCatId+'">'+optFinDisplayName+"</label>"),$input.addClass("ui-opt-parenthiddenchild-child"),$label.addClass("ui-opt-parenthiddenchild-child"),$label.css("border-left","8px solid "+optFinColor),$label.on("vmousedown",(function(e){var labelId=$(this).attr("id"),inputId=labelId.replace("lbl","btn"),$inputEl=$("#"+inputId),inputParentId=$inputEl.attr("data-parent");$inputEl.attr("checked")?optionsVizCurrentlySelected=void 0:(optionsVizCurrentlySelected=labelId,$('input[data-parent="'+inputParentId+'"]').each((function(){$(this).attr("id")!=labelId&&$(this).attr("checked")&&$(this).attr("checked",!1).checkboxradio("refresh").trigger("change")})))})),$optGroup.append($input),$optGroup.append($label)}))}))})),$optsList.append($optGroup),$optsDiv.append($optsList),$optsDiv.trigger("create"),$optsDiv.find("label").each((function(){if($label=$(this),labelId=$label.attr("id"),optId="o-"+strStripNonNumeric($label.attr("id")),$opt=$dataOptions.find('option[id="'+optId+'"]'),($img=$label.find("img")).prependTo($label),$img.css("display","block"),$label.find("div").appendTo($label),$label.find("br").remove(),$label.hasClass("ui-opt-parenthiddenchild-parent")?$label.parent().addClass("ui-opt-parenthiddenchild-parent"):$label.hasClass("ui-opt-parenthiddenchild-child")&&($label.parent().addClass("ui-opt-parenthiddenchild-child"),1==$opt.attr("selected")&&(optionsVizCurrentlySelected=labelId,setTimeout('optionsVizOptionShow("'+labelId+'")',100)),$label.parent("div").on("mouseenter mouseleave vmousedown",(function(e){var labelIdHover=$(this).children("label").attr("id");"mouseenter"===e.type||"vmousedown"===e.type?executeAfterFinal('optionsVizOptionShow("'+labelIdHover+'")',50,"optionsVizShow-optionsVizOptionShowHide"):executeAfterFinal(optionsVizOptionHide,50,"optionsVizShow-optionsVizOptionShowHide")}))),$label.hasClass("ui-opt-scheme")){for($label.parent().addClass("ui-opt-scheme"),labelId=$label.attr("id"),optId="o-"+strStripNonNumeric($label.attr("id")),$opt=$dataOptions.find('option[id="'+optId+'"]'),optOptionsList=(optOptionsList=(optOptionsList=$opt.attr("data1")).replace(/^,|,$/g,"")).split(","),1==$opt.attr("selected")&&(optionsVizCurrentlySelected=labelId,setTimeout('optionsVizSchemeShow("'+labelId+'")',100)),i=0;i<4;i++)$opt=$dataOptions.find("option[id=o-"+optOptionsList[i]+"]"),optColor=$opt.attr("data2"),$('<div class="ui-opt-scheme-swatch" style="background:'+optColor+'"></div>').prependTo($label);$label.parent("div").on("mouseenter mouseleave vmousedown",(function(e){var labelIdHover=$(this).children("label").attr("id");"mouseenter"===e.type||"vmousedown"===e.type?executeAfterFinal('optionsVizSchemeShow("'+labelIdHover+'")',50,"optionsVizShow-optionsVizSchemeShowHide"):executeAfterFinal(optionsVizSchemeHide,50,"optionsVizShow-optionsVizSchemeShowHide")}))}})),$("#layoutAccordion .ui-collapsible-content .ui-collapsible-content").css("flex-flow","unset");var $vizSelected=$optsDiv.find('input[type="radio"]:checked:first');!$vizSelected||$vizSelected.length<=0?(($vizSelected=$optsDiv.find('input[type="radio"]:first')).attr("checked",!0).checkboxradio("refresh").trigger("change"),$optsDiv.find("label.ui-opt-parenthiddenchild-parent:first").trigger("click")):$vizSelected.checkboxradio("refresh").trigger("change"),$optsDiv.addClass("viz")}function optionsVizSelect(e){var $divImgs=$("#divImgs"),$optsDiv=$("#layoutOptionsImgs"),labelId=$(this).attr("id"),inputId=labelId.replace("lbl","btn"),$inputEl=$("#"+inputId);if($inputEl.is(":checked")){$inputEl.parents(".ui-controlgroup-controls").find("input[type=radio]").each((function(){$(this).attr("id")!==inputId&&$(this).attr("checked",!1).checkboxradio("refresh").trigger("change")})),$optsDiv.find(".ui-radio-btnoverlay").show(),$inputEl.parent().find("div").hide(),$('input.ui-opt-parenthiddenchild-parent[type="checkbox"][data-parent="'+inputId+'"]').parent().slideDown(),$('input.ui-opt-scheme[type="checkbox"][data-parent="'+inputId+'"]').parent().slideDown(),$('input.ui-opt-parenthiddenchild-parent[type="checkbox"][data-parent][data-parent="'+inputId+'"]').each((function(){$(this).attr("checked",!1).checkboxradio("refresh")})),$('input[type="checkbox"][data-parent][data-parent!="'+inputId+'"]').parent().slideUp(),$('input.ui-opt-parenthiddenchild-parent[type="checkbox"][data-parent][data-parent!="'+inputId+'"]').each((function(){$(this).attr("checked",!0).checkboxradio("refresh")}));var visId="og-"+strStripNonNumeric(labelId);$divImgs.find("div.imgs-vis-wrapper[data-for="+visId+"]").fadeIn("fast"),$divImgs.find("div.imgs-vis-wrapper[data-for!="+visId+"]").fadeOut("fast")}uiOptionSelect.call(this)}function optionsVizOptionShow(labelId){labelId?optionsVizCurrentlyHighlighted=labelId:labelId=optionsVizCurrentlyHighlighted;var $divImgs=$("#divImgs"),inputId=labelId.replace("lbl","btn"),inputParentId=$("#"+inputId).attr("data-parent"),optId="o-"+strStripNonNumeric(labelId),optImgPath=$dataOptions.find("option[id="+optId+"]").attr("data1"),optCatId="o-"+strStripNonNumeric(inputParentId),$cat=$dataOptions.find("option[id="+optCatId+"]"),catFolder=$cat.attr("data1"),$vis=$cat.parent(),visId="og-"+strStripNonNumeric($vis.attr("id")),imgFullPath=$vis.attr("filespath")+catFolder+"/"+optImgPath;if($divVisImgWrapper=$divImgs.find("div.imgs-vis-wrapper[data-for="+visId+"]"),$divImgWrapper=$divImgs.find("div.imgs-wrapper[data-for="+optCatId+"]"),$divImgWrapper.length||($divImgWrapper=$('<div class="imgs-wrapper imgs-overlay" data-for="'+optCatId+'"><img class="imgs-img" /><div class="imgs-txt"></div></div>'),$divImgWrapper.appendTo($divVisImgWrapper)),1==$cat.attr("toplayer")){var zindex=$cat.attr("displayorder")?$cat.attr("displayorder"):0;zindex=parseInt(zindex,10)+1,$divImgWrapper.css("z-index",zindex)}$divImgWrapper.find(".imgs-img").attr("src",imgFullPath),$divImgWrapper.css("opacity","1")}function optionsVizOptionHide(labelId){labelId||(labelId=optionsVizCurrentlyHighlighted);var $divImgs=$("#divImgs"),inputId=labelId.replace("lbl","btn"),inputParentId=$("#"+inputId).attr("data-parent"),optCatId=strStripNonNumeric(inputParentId),$divImgWrapper=$divImgs.find("div.imgs-wrapper[data-for=o-"+optCatId+"]");optionsVizCurrentlySelected=void 0,$('input[data-parent="'+inputParentId+'"]').each((function(){$(this).attr("checked")&&(optionsVizCurrentlySelected=$(this).attr("id"))})),void 0===optionsVizCurrentlySelected?$divImgWrapper.remove():optionsVizOptionShow(optionsVizCurrentlySelected)}function optionsVizSchemeShow(labelId){labelId?optionsVizCurrentlyHighlighted=labelId:labelId=optionsVizCurrentlyHighlighted;var $divImgs=$("#divImgs"),inputId=labelId.replace("lbl","btn"),optId=($("#"+inputId),"o-"+strStripNonNumeric(labelId)),$opt=$dataOptions.find('option[id="'+optId+'"]'),optOptionsList=$opt.attr("data1");optOptionsList=(optOptionsList=optOptionsList.replace(/^,|,$/g,"")).split(",");var optImgPath,optCatId,$cat,catFolder,$divImgWrapper,$vis=$opt.parent(),visId="og-"+strStripNonNumeric($vis.attr("id")),visPath=$vis.attr("filespath"),$divVisImgWrapper=$divImgs.find('div.imgs-vis-wrapper[data-for="'+visId+'"]');$divVisImgWrapper.find("div.imgs-overlay").css("opacity","0"),($divImgWrapper=$divVisImgWrapper.find('div.imgs-overlay[data-for="'+optId+'"]')).length?$divImgWrapper.css("opacity","1"):$.each(optOptionsList,(function(key,val){if($opt=$dataOptions.find("option[id=o-"+val+"]"),optImgPath=$opt.attr("data1"),optCatId="o-"+$opt.attr("parentoptionid"),$cat=$dataOptions.find("option[id="+optCatId+"]"),catFolder=$cat.attr("data1"),$divImgWrapper=$('<div class="imgs-wrapper imgs-overlay" data-for="'+optId+'"><img class="imgs-img" src="'+(visPath+catFolder+"/"+optImgPath)+'" /><div class="imgs-txt"></div></div>'),1==$cat.attr("toplayer")){var zindex=$cat.attr("displayorder")?$cat.attr("displayorder"):0;zindex=parseInt(zindex,10)+1,$divImgWrapper.css("z-index",zindex)}$divImgWrapper.appendTo($divVisImgWrapper),$divImgWrapper.css("opacity","1")}))}function optionsVizSchemeHide(labelId){labelId||(labelId=optionsVizCurrentlyHighlighted);var $divImgs=$("#divImgs"),inputId=labelId.replace("lbl","btn"),optId=($("#"+inputId),"o-"+strStripNonNumeric(labelId)),$vis=$dataOptions.find('option[id="'+optId+'"]').parent(),visId="og-"+strStripNonNumeric($vis.attr("id")),$divImgWrapper=$divImgs.find('div.imgs-vis-wrapper[data-for="'+visId+'"]').find('div.imgs-overlay[data-for="'+optId+'"]');void 0===optionsVizCurrentlySelected?$divImgWrapper.css("opacity","0"):optionsVizSchemeShow(optionsVizCurrentlySelected)}function optionsImgsPreload(){$dataViews.find('view[type="ext"]').each((function(){$dataOptions.find('group[viewid="'+strStripNonNumeric($(this).attr("id"))+'"]').find("option").each((function(){var $optionXmlNode=$(this);$("<img/>").attr("src",imgGetSrcRetina($optionXmlNode.attr("data1"),!0)),$("<img/>").attr("src",imgGetSrcRetina($optionXmlNode.attr("data2"),!0))}))}))}function optionsImgsShow(floorIndex){var $optsList,optGroupID,optGroupDisplayName,optID,optDisplayName,optImgPath,optChecked,optDisabled,$optXMLNode,$optGroup,$input,$label,$img,viewID=$($dataViews.find("view")[floorIndex]).attr("id"),viewDBID=strStripNonNumeric(viewID),isFlippedH="true"===$dataInfo.attr("flippedh"),$optsDiv=$("#layoutOptionsImgs > div"),$divImgs=$("#divImgs");$optsDiv.empty(),$divImgs.empty(),$dataOptions.find("group[viewid="+viewDBID+"]").each((function(){optGroupID=$(this).attr("id"),optGroupDisplayName=$(this).attr("displayname"),$optsList=$('<div data-role="collapsible" data-inset="false" data-mini="true" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d" data-iconpos="right"><h3>'+optGroupDisplayName+"</h3></div>"),$optGroup=$('<fieldset data-role="controlgroup" data-mini="true"></fieldset>'),$(this).find("option").each((function(){$optXMLNode=$(this),optID=$optXMLNode.attr("id"),optDisplayName=$optXMLNode.attr("displayname"),optImgPath=$optXMLNode.attr("data1"),optChecked="1"===$optXMLNode.attr("selected")?'checked="checked"':"",optDisabled="0"===$optXMLNode.attr("enabled")?'disabled="disabled"':"",$input=$('<input type="radio" name="btnOptionGroup_'+optGroupID+'" id="btnOption_'+optID+'" '+optDisabled+" "+optChecked+" />"),$label=$('<label id="lblOption_'+optID+'" for="btnOption_'+optID+'"><br/>'+optDisplayName+"</label>"),$img=$('<img class="imgs-thumb" width="234" src="'+optImgPath+'"/>'),isFlippedH&&$img.css("transform","scale(-1,1)"),$img.imgRetina({new_base_src:optImgPath}),$label.prepend($img),$input.on("click",uiOptionsImgSelect),$optGroup.append($input),$optGroup.append($label)})),$optGroup.find("label").on("vmousedown",(function(e){if(!isTouchDevice())return killEvent(e)})),$optGroup.find("label").on("vmouseover",(function(e){if(!isTouchDevice())return killEvent(e)})),$optsList.append($optGroup),$optsDiv.append($optsList)})),$optsDiv.trigger("create"),$optsDiv.find("label").each((function(){$label=$(this),($img=$label.find("img")).prependTo($label),$img.css("display","block"),$label.find("br").remove()})),$optsDiv.find("input:checked").trigger("click"),$("#layoutAccordion .ui-collapsible-content .ui-collapsible-content").css("flex-flow","unset")}function uiOptionsImgSelect(){var id=$(this).attr("id").split("_")[1],$optionXmlNode=$dataOptions.find("option[id="+id+"]");$optionXmlNode.parent().find("option").attr("selected","0"),$optionXmlNode.attr("selected","1");var $imgPreview=$("#imgPreview"),pathPreviewImg=$optionXmlNode.attr("data1");pathPreviewImg&&$imgPreview.attr("src",imgGetSrcRetina(pathPreviewImg)),uiOptionsImgSelect_Helper($optionXmlNode,!0),optionPricingRefresh(!0),optionsAnalyticsTrackEvent(id,!0)}function uiOptionsImgSelect_Helper($optionXmlNode,tryRetina){tryRetina=!!tryRetina;var $divImgs=$("#divImgs"),text=$optionXmlNode.attr("displayname"),pathImg=$optionXmlNode.attr("data2");if($("#divPreviewLabel").children("span").text(text),pathImg){var $wrapper=$('<div class="imgs-wrapper"><img class="imgs-img" /><div class="imgs-txt"></div></div>');tryRetina?$wrapper.find(".imgs-img").attr("src",imgGetSrcRetina(pathImg,tryRetina)):$wrapper.find(".imgs-img").attr("src",pathImg),text&&$wrapper.find(".imgs-txt").text(text),$wrapper.appendTo($divImgs)}$divImgs.imagesLoaded().done((function(imgsLoaded){imgsLoaded.images.length>0&&$(imgsLoaded.images[imgsLoaded.images.length-1].img).parent().fadeTo(EFFECT_SPEED_FADE_IN,1,(function(){imgsLoaded.images.length>1&&$(imgsLoaded.images[imgsLoaded.images.length-2].img).parent().remove()}))})).fail((function(imgsLoaded){$(imgsLoaded.images[imgsLoaded.images.length-1].img).parent().remove(),tryRetina&&uiOptionsImgSelect_Helper($optionXmlNode,!1)}))}function optionsUpdateState(optionID,doVisible,doEnable,doSelect){var visible,enabled,selected,$optionNode=$dataOptions.find("option[id="+optionID+"]");(!$optionNode||$optionNode.length<=0)&&($optionNode=$dataOptions.find("group[id="+optionID+"]")),visible=void 0===doVisible?"1"===$optionNode.attr("visible"):doVisible,enabled=void 0===doEnable?"1"===$optionNode.attr("enabled"):doEnable,selected=void 0===doSelect?"1"===$optionNode.attr("selected"):doSelect,!1!==visible&&!1!==enabled||(selected=!1),visible?$optionNode.attr("visible","1"):$optionNode.attr("visible","0"),enabled?$optionNode.attr("enabled","1"):$optionNode.attr("enabled","0"),selected?$optionNode.attr("selected","1"):$optionNode.attr("selected","0"),now=new Date,elapsed=now.getTime()-dataSoftSaveTimer,elapsed>dataSoftSaveInterval&&(dataPlanSave("txt",!1,1),dataSoftSaveTimer=now.getTime())}function optionsUpdateUI(optionID){var $optionNode=$dataOptions.find("option[id="+optionID+"]");if($optionNode.parent().attr("viewid")===strStripNonNumeric(uiViewsCurrentID)&&(!$optionNode.parent().attr("typecode")||-1===$optionNode.parent().attr("typecode").indexOf("vis"))){var visible,enabled,selected,$checkbox=$("#btnOption_"+optionID);visible="1"===$optionNode.attr("visible"),enabled="1"===$optionNode.attr("enabled"),selected="1"===$optionNode.attr("selected"),!1!==visible&&!1!==enabled||(selected=!1),$checkbox.attr("disabled",!enabled),$checkbox.attr("checked",selected),$checkbox.checkboxradio("refresh"),optionsUpdateUI_Stage(optionID,selected),visible?$checkbox.parent().slideDown():$checkbox.parent().slideUp(),svgPlanOptionShowHide(optionID,selected,uiViewsCurrentID),selected&&svgPlanOptionHighlight(optionID,!0)}}function optionsUpdateUI_Stage(optionID,show){var $optionNode=$dataOptions.find("option[id="+optionID+"]");svgPlanOptionShowHide(optionID,show,uiViewsCurrentID),show&&svgPlanOptionHighlight(optionID,!0),$optionNode.attr("selected",show?1:0)}function optionPricingRefresh(bAnimateChanges){var $layoutLegend=$("#layoutLegend"),$tblPricing=$("#tblLegendPricing");$rowPrevious=$tblPricing.find("tr.base");var $optionXmlNode,$rowOption,optionIsSelected,optionID,optionName,optionPrice,rowID,totalPrice,totalPricePrevious,$rowTotal=$tblPricing.find("tr.total"),$cellTotal=$rowTotal.find("td:nth-child(1)"),basePrice=$dataInfo.attr("baseprice");optionPricingIsEnabled()||(basePrice=void 0),$layoutLegend&&$layoutLegend.is(":visible")&&void 0!==basePrice&&(basePrice=parseFloat(basePrice),totalPrice=basePrice,$dataOptions.find("option").each((function(){$optionXmlNode=$(this),optionIsSelected=$optionXmlNode.attr("selected"),optionName=$optionXmlNode.attr("displayname"),void 0!==(optionPrice=$optionXmlNode.attr("pricingdelta"))&&(optionPrice=parseFloat(optionPrice),optionID=$optionXmlNode.attr("id"),rowID="pr-"+optionID,$rowOption=$tblPricing.find('tr[id="'+rowID+'"]'),1==optionIsSelected?($rowOption.is(":visible")||($rowOption=$('<tr id="'+rowID+'"><td>'+strFormatCurrency(optionPrice,0)+"</td><td>"+optionName+"</td></tr>"),bAnimateChanges?(optionPricingRefresh_RecentItemFade(),$optionsPricingRecentFadeItem=$rowOption,$rowOption.hide().insertAfter($rowPrevious),$rowOption.css("color",OPTION_COLOR_HIGHLIGHT_2).stop(!1,!0).slideDown((function(){optionsPricingRecentFadeTimeout=setTimeout(optionPricingRefresh_RecentItemFade,3e3)}))):$rowOption.insertAfter($rowPrevious)),$rowPrevious=$rowOption,totalPrice+=optionPrice):bAnimateChanges?$rowOption.stop(!1,!0).slideUp((function(){$rowOption.remove()})):$rowOption.remove())})),bAnimateChanges&&$tblPricing.find("tr:visible").length<2?bAnimateChanges?$rowTotal.fadeOut(EFFECT_SPEED_FADE_OUT,(function(){$cellTotal.text(0)})):$cellTotal.text(0):(totalPricePrevious=$cellTotal.text(),totalPrice=strFormatCurrency(totalPrice,0),bAnimateChanges&&totalPrice!==totalPricePrevious?($cellTotal.fadeOut(EFFECT_SPEED_FADE_OUT,(function(){$cellTotal.text(totalPrice).fadeIn(EFFECT_SPEED_FADE_IN),$rowTotal.fadeIn()})),$("#divLegend").animate({scrollTop:$rowTotal.offset().top})):($cellTotal.text(totalPrice),$rowTotal.show())))}function optionPricingIsEnabled(){var isLoggedInUser=void 0!==$dataCurrentUser,clientEnableOptionPricing=$dataInfo.attr("clientenableoptionpricing"),clientAllowOptionPricingWithoutBasePrice=$dataInfo.attr("clientallowoptionpricingwithoutbaseprice"),planEnableOptionPricing=$dataInfo.attr("planenableoptionpricing"),clientMinimumOptionPricingCompletionRate=$dataInfo.attr("clientminimumoptionpricingcompletionrate"),planPricingCompletionRate=$dataInfo.attr("pricingcompletionrate"),planBasePrice=$dataInfo.attr("baseprice"),enabled=!1;return"1"==clientEnableOptionPricing&&"1"==planEnableOptionPricing&&("1"==clientAllowOptionPricingWithoutBasePrice||void 0!==planBasePrice&&"0.00"!==planBasePrice)&&(isLoggedInUser||planPricingCompletionRate>=clientMinimumOptionPricingCompletionRate)&&(enabled=!0),enabled}function optionSquareFootageIsEnabled(){var isLoggedInUser=void 0!==$dataCurrentUser,clientEnableOptionSquareFootage=$dataInfo.attr("clientenableoptionsquarefootage"),planEnableOptionSquareFootage=$dataInfo.attr("planenableoptionsquarefootage"),clientMinimumOptionSquareFootageCompletionRate=$dataInfo.attr("clientminimumoptionsquarefootagecompletionrate"),planSquareFootageCompletionRate=$dataInfo.attr("squarefootagecompletionrate"),planBaseSquareFootage=$dataInfo.attr("basesquarefootage"),enabled=!1;return"1"==clientEnableOptionSquareFootage&&"1"==planEnableOptionSquareFootage&&void 0!==planBaseSquareFootage&&(isLoggedInUser||planSquareFootageCompletionRate>=clientMinimumOptionSquareFootageCompletionRate)&&(enabled=!0),enabled}function optionPricingRefresh(bAnimateChanges){var $tblPricing=$("#tblLegendPricing");$rowPrevious=$tblPricing.find("tr.base");var $optionXmlNode,$rowOption,optionIsSelected,optionID,optionName,optionPrice,rowID,totalPrice,totalPricePrevious,totalSqFtPrevious,totalSqFt,$rowTotal=$tblPricing.find("tr.total"),$cellTotal=$rowTotal.find("td:nth-child(1)"),$cellTotalSqFt=$rowTotal.find("td:nth-child(3)"),$cellAsShown=$("#spanPriceAsShownNumber"),$sqftAsShown=$("#spanSqFtAsShownText"),basePrice="";optionPricingIsEnabled()&&(basePrice=$dataInfo.attr("baseprice"));var baseSqFt="";optionSquareFootageIsEnabled()&&(void 0===(baseSqFt=$dataInfo.attr("basesquarefootage"))||0==baseSqFt||isNaN(baseSqFt))&&(baseSqFt="");var $divMenuLegend=$("#divMenuLegend");if((""!=basePrice&&"0.00"!=basePrice||""!=baseSqFt)&&$divMenuLegend.is(":visible"))if(""!=basePrice&&"0.00"!=basePrice&&(basePrice=parseFloat(basePrice),totalPrice=basePrice),""!=baseSqFt&&(baseSqFt=parseFloat(baseSqFt),totalSqFt=baseSqFt),$dataOptions.find("option").each((function(){if($optionXmlNode=$(this),optionIsSelected=$optionXmlNode.attr("selected"),optionName=$optionXmlNode.attr("displayname"),optionPrice=$optionXmlNode.attr("pricingdelta"),optionSqFt=$optionXmlNode.attr("squarefootagedelta"),""!=basePrice&&void 0!==optionPrice||""!=baseSqFt&&void 0!==optionSqFt)if(optionPrice=parseFloat(optionPrice),optionSqFt=parseFloat(optionSqFt),(void 0===optionSqFt||isNaN(optionSqFt)||""==optionSqFt)&&(optionSqFt=""),""!=baseSqFt&&""!=optionSqFt?optionSqFtText=parseFloat(optionSqFt).toFixed(0).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+$dataInfo.attr("clientareatext"):optionSqFtText="",optionID=$optionXmlNode.attr("id"),rowID="pr-"+optionID,$rowOption=$tblPricing.find('tr[id="'+rowID+'"]'),1==optionIsSelected){if(!$rowOption.length){var optionPriceText="";""!=basePrice&&void 0!==optionPrice&&(optionPriceText=strFormatCurrency(optionPrice,0)),$rowOption=$('<tr id="'+rowID+'"><td>'+optionPriceText+"</td><td>"+optionName+"</td><td align=right>"+optionSqFtText+"</td></tr>"),bAnimateChanges?(optionPricingRefresh_RecentItemFade(),$optionsPricingRecentFadeItem=$rowOption,$rowOption.hide().insertAfter($rowPrevious),$rowOption.css("color",OPTION_COLOR).stop(!1,!0).slideDown((function(){optionsPricingRecentFadeTimeout=setTimeout(optionPricingRefresh_RecentItemFade,3e3)}))):$rowOption.insertAfter($rowPrevious)}$rowPrevious=$rowOption,totalPrice+=optionPrice,""!=optionSqFtText&&(totalSqFt+=optionSqFt)}else bAnimateChanges?$rowOption.stop(!1,!0).slideUp(EFFECT_SPEED_FADE_OUT,(function(){$(this).remove()})):$rowOption.remove()})),""==basePrice&&$("#tblLegendPricing tr td:nth-child(1)").css("width",0),bAnimateChanges&&$tblPricing.find("tr").length<2)bAnimateChanges?$rowTotal.fadeOut(EFFECT_SPEED_FADE_OUT,(function(){$cellTotal.text(0),$cellTotalSqFt.text(0)})):($cellTotal.text(0),$cellTotalSqFt.text(0));else if(totalSqFtPrevious=$sqftAsShown.text(),void 0===totalSqFt||0==totalSqFt||""==totalSqFt||isNaN(totalSqFt)?totalSqFtText="":totalSqFtText=parseFloat(totalSqFt).toFixed(0).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+$dataInfo.attr("clientareatext"),totalPricePrevious=$cellTotal.text(),totalPrice=void 0===totalPrice||0==totalPrice||""==totalPrice||isNaN(totalPrice)?"":strFormatCurrency(totalPrice,0),!bAnimateChanges||totalPrice===totalPricePrevious&&totalSqFt===totalSqFtPrevious){$cellTotal.text(totalPrice),$cellTotalSqFt.text(totalSqFtText),$cellAsShown.text(totalPrice);var prefix=" • ";""==totalPrice&&(prefix=""),""!=totalSqFtText?$sqftAsShown.text(prefix+totalSqFtText):$sqftAsShown.text(""),$rowTotal.show()}else $cellTotal.fadeOut(EFFECT_SPEED_FADE_OUT,(function(){$cellAsShown.text(totalPrice);var prefix=" • ";""==totalPrice&&(prefix=""),""!=totalSqFtText&&$sqftAsShown.text(prefix+totalSqFtText),$cellTotal.text(totalPrice).fadeIn(EFFECT_SPEED_FADE_IN),$cellTotalSqFt.text(totalSqFtText).fadeIn(EFFECT_SPEED_FADE_IN),$rowTotal.fadeIn(EFFECT_SPEED_FADE_IN)})),$("#divLegend").animate({scrollTop:$rowTotal.offset().top})}function optionPricingRefresh_RecentItemFade(){void 0!==optionsPricingRecentFadeTimeout&&clearTimeout(optionsPricingRecentFadeTimeout),void 0!==$optionsPricingRecentFadeItem&&$optionsPricingRecentFadeItem.stop(!1,!0).css("color","inherit")}function optionsLogicInitialize(viewID){if(optionsLogicIsInitRun=!0,$dataOptions&&$dataOptionsLogic&&$dataOptionsLogic.length){var worker=new Worker("/scripts/src/vip.options.logic.worker.js");worker.addEventListener("message",(function(e){var data=e.data;if("finished"===data)$.each(optionsSetupInitiallySelected,(function(key,val){optionsUpdateState(val,!0,!0,!0),optionsLogicProcessOption(val)})),optionsSetupInitiallySelected=[],optionsLogicIsInitRun=!1,$dataOptions.find("option").each((function(){optionsUpdateUI($(this).attr("id"))})),optionPricingRefresh(!1),$("#layoutOptions .ui-collapsible-content").children().fadeIn(EFFECT_SPEED_FADE_IN),$("#layoutOptions").removeClass("ui-loading"),worker.terminate();else if(void 0!==data.dataOptionsJSON){var x2js=new X2JS;$dataOptions=$($.parseXML(x2js.json2xml_str(data.dataOptionsJSON)))}}),!1);var x2js=new X2JS({arrayAccessFormPaths:["options.group","options.group.option","optionslogic.logic"]}),$dataOptionsJSON=x2js.xml_str2json(xmlToString($dataOptions.eq(0)[0])),$dataOptionsLogicJSON=x2js.xml_str2json(xmlToString($dataOptionsLogic.eq(0)[0]));worker.postMessage({viewID:viewID}),worker.postMessage({dataOptionsJSON:$dataOptionsJSON}),worker.postMessage({dataOptionsLogicJSON:$dataOptionsLogicJSON}),worker.postMessage({clientlogicforceparenthiddenchild:$dataInfo.attr("clientlogicforceparenthiddenchild")}),worker.postMessage("start")}}function optionsLogicInitialize_old(viewID){var $logicNode,optionDBIDs;optionsLogicIsInitRun=!0,$dataOptionsLogic.find("logic").each((function(){$logicNode=$(this),void 0!==(optionDBIDs=$logicNode.attr("optionids"))&&(optionDBIDs=(optionDBIDs=optionDBIDs.replace(/^,|,$/g,"")).split(","),$.each(optionDBIDs,(function(key,val){optionsLogicProcessOption("o-"+val)})))})),$.each(optionsSetupInitiallySelected,(function(key,val){optionsUpdateState(val,!0,!0,!0),optionsLogicProcessOption(val)})),optionsSetupInitiallySelected=void 0,optionsLogicIsInitRun=!1,$dataOptions.find("option").each((function(){optionsUpdateUI($(this).attr("id"))})),$("#layoutOptions .ui-collapsible-content").children().show()}function optionsLogicProcessOption(optionID){optionsLogicDbgIndent=0,dbgSetIndent(++optionsLogicDbgIndent),optionsLogicProcessOption_ProcessedItems={};var levelsOptionIDs=[];levelsOptionIDs.push([optionID]);var iMaxLevelToProcess=21;optionsLogicIsInitRun&&(iMaxLevelToProcess=0);for(var i=0;i<=iMaxLevelToProcess;i++){if(i>20){var strWarning="optionsLogicProcessOption: !!!!!!!!!!!!!!! LOGIC ISSUE! One or more rules resulted in more than 20 levels to process. The root OptionID that started the cascade was: "+optionID;console.warn(strWarning);break}if(levelsOptionIDs[i+1]=optionsLogicProcessOption_DoLevel(levelsOptionIDs[i]),void 0===levelsOptionIDs[i+1]||levelsOptionIDs[i+1].length<=0)break}optionsLogicProcessOption_ProcessedItems=void 0,optionsLogicDbgIndent=0,dbgSetIndent(optionsLogicDbgIndent)}function optionsLogicProcessOption_DoLevel(optionIDs){dbgSetIndent(++optionsLogicDbgIndent);var affectedOptionIDsTmp,logicTypesToProcessFlag,affectedOptionIDs=[];return logicTypesToProcessFlag=OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.flag|OPTION_LOGIC_TYPE_PARENTCHILD.flag|OPTION_LOGIC_TYPE_MUTEX.flag|OPTION_LOGIC_TYPE_GROUP.flag,$.each(optionIDs,(function(key,val){affectedOptionIDsTmp=optionsLogicProcessOption_DoLevelHelper(val,logicTypesToProcessFlag),$.merge(affectedOptionIDs,affectedOptionIDsTmp)})),affectedOptionIDs}function optionsLogicProcessOption_DoLevelHelper(affectingOptionID,logicTypesToProcessFlag){var $logicNode,logicID,logicAffectedOptionIDs,logicAffectedOptionID,affectedOptionIDs=[],$affectingOptionNode=$dataOptions.find("option[id="+affectingOptionID+"]"),affectingIsVisible="1"===$affectingOptionNode.attr("visible"),affectingIsEnabled="1"===$affectingOptionNode.attr("enabled"),affectingIsSelected="1"===$affectingOptionNode.attr("selected");0!=affectingIsVisible&&!1!==affectingIsEnabled||(affectingIsSelected=!1);var affectingOptionDBID=strStripNonNumeric(affectingOptionID);return(logicTypesToProcessFlag&OPTION_LOGIC_TYPE_PARENTCHILD.flag)!==OPTION_LOGIC_TYPE_PARENTCHILD.flag&&(logicTypesToProcessFlag&OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.flag)!==OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.flag||$dataOptionsLogic.find('logic[optionids*=",'+affectingOptionDBID+',"]').filter('[type="'+OPTION_LOGIC_TYPE_PARENTCHILD.code+'"],[type="'+OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code+'"]').each((function(){$logicNode=$(this),optionsLogicProcessOption_ProcessedItemAdd(logicID=$logicNode.attr("id"),affectingOptionID),logicAffectedOptionIDs=(logicAffectedOptionIDs=(logicAffectedOptionIDs=$logicNode.attr("childoptionids")).replace(/^,|,$/g,"")).split(","),$.each(logicAffectedOptionIDs,(function(key,val){(logicAffectedOptionID="o-"+val)!==affectingOptionID&&(optionsLogicProcessOption_ProcessedItemExists(logicID,logicAffectedOptionID)||(affectingIsSelected?(optionsLogicProcessOption_DisablersRemove(logicAffectedOptionID,logicID,affectingOptionID),optionsLogicProcessOption_DisablersExist(logicAffectedOptionID,logicID,affectingOptionID)?$logicNode.attr("type")===OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code&&optionsUpdateState(logicAffectedOptionID,!0,void 0,void 0):($logicNode.attr("type")===OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code?optionsUpdateState(logicAffectedOptionID,!0,!0,void 0):optionsUpdateState(logicAffectedOptionID,void 0,!0,void 0),affectedOptionIDs.push(logicAffectedOptionID))):($logicNode.attr("type")===OPTION_LOGIC_TYPE_PARENTHIDDENCHILD.code?optionsUpdateState(logicAffectedOptionID,!1,!1,!1):optionsUpdateState(logicAffectedOptionID,void 0,!1,!1),affectedOptionIDs.push(logicAffectedOptionID),optionsLogicProcessOption_DisablersAdd(logicAffectedOptionID,logicID,affectingOptionID)),optionsUpdateUI(logicAffectedOptionID)))}))})),(logicTypesToProcessFlag&OPTION_LOGIC_TYPE_MUTEX.flag)===OPTION_LOGIC_TYPE_MUTEX.flag&&$dataOptionsLogic.find('logic[optionids*=",'+affectingOptionDBID+',"][type="'+OPTION_LOGIC_TYPE_MUTEX.code+'"]').each((function(){$logicNode=$(this),optionsLogicProcessOption_ProcessedItemAdd(logicID=$logicNode.attr("id"),affectingOptionID),logicAffectedOptionIDs=(logicAffectedOptionIDs=(logicAffectedOptionIDs=$logicNode.attr("optionids")).replace(/^,|,$/g,"")).split(","),$.each(logicAffectedOptionIDs,(function(key,val){(logicAffectedOptionID="o-"+val)!==affectingOptionID&&(optionsLogicProcessOption_ProcessedItemExists(logicID,logicAffectedOptionID)||(affectingIsSelected?(optionsUpdateState(logicAffectedOptionID,void 0,!1,!1),optionsUpdateUI(logicAffectedOptionID),affectedOptionIDs.push(logicAffectedOptionID),optionsLogicProcessOption_DisablersAdd(logicAffectedOptionID,logicID,affectingOptionID)):(optionsLogicProcessOption_DisablersRemove(logicAffectedOptionID,logicID,affectingOptionID),optionsLogicProcessOption_DisablersExist(logicAffectedOptionID,logicID,affectingOptionID)||(optionsUpdateState(logicAffectedOptionID,void 0,!0,void 0),optionsUpdateUI(logicAffectedOptionID),affectedOptionIDs.push(logicAffectedOptionID)))))}))})),(logicTypesToProcessFlag&OPTION_LOGIC_TYPE_GROUP.flag)===OPTION_LOGIC_TYPE_GROUP.flag&&$dataOptionsLogic.find('logic[optionids*=",'+affectingOptionDBID+',"][type="'+OPTION_LOGIC_TYPE_GROUP.code+'"]').each((function(){$logicNode=$(this),optionsLogicProcessOption_ProcessedItemAdd(logicID=$logicNode.attr("id"),affectingOptionID),logicAffectedOptionIDs=(logicAffectedOptionIDs=(logicAffectedOptionIDs=$logicNode.attr("optionids")).replace(/^,|,$/g,"")).split(","),$.each(logicAffectedOptionIDs,(function(key,val){(logicAffectedOptionID="o-"+val)!==affectingOptionID&&(optionsLogicProcessOption_ProcessedItemExists(logicID,logicAffectedOptionID)||(affectingIsSelected?(optionsUpdateState(logicAffectedOptionID,void 0,void 0,!0),optionsUpdateUI(logicAffectedOptionID),affectedOptionIDs.push(logicAffectedOptionID)):(optionsUpdateState(logicAffectedOptionID,void 0,void 0,!1),optionsUpdateUI(logicAffectedOptionID),affectedOptionIDs.push(logicAffectedOptionID))))}))})),affectedOptionIDs}function optionsLogicProcessOption_ProcessedItemAdd(logicID,optionID){var optionIDArray=optionsLogicProcessOption_ProcessedItems[logicID];void 0===optionIDArray&&(optionIDArray=[]),-1===$.inArray(optionID,optionIDArray)&&(optionIDArray.push(optionID),optionsLogicProcessOption_ProcessedItems[logicID]=optionIDArray)}function optionsLogicProcessOption_ProcessedItemExists(logicID,optionID){var optionIDArray=optionsLogicProcessOption_ProcessedItems[logicID];return void 0===optionIDArray&&(optionIDArray=[]),-1!==$.inArray(optionID,optionIDArray)}function optionsLogicProcessOption_DisablersAdd(optionID,disablingLogicIDToAdd,disablingOptionIDToAdd){var disablingSet=disablingLogicIDToAdd+"|"+disablingOptionIDToAdd,$optionNode=$dataOptions.find("option[id="+optionID+"]");if(null!=$optionNode){var disablers=$optionNode.attr("disablers");disablers?(("string"==typeof disablers||disablers instanceof String)&&(disablers=-1!==disablers.indexOf(",")?disablers.split(","):[disablers]),-1===disablers.indexOf(disablingSet)&&disablers.push(disablingSet),disablers=typeof disablers==typeof Array?disablers.length>1?disablers.join(","):String(disablers[0]):String(disablers)):disablers=disablingSet,void 0===disablers&&(disablers=""),$optionNode.attr("disablers",disablers)}}function optionsLogicProcessOption_DisablersRemove(optionID,disablingLogicIDToRemove,disablingOptionIDToRemove){var disablingSet=disablingLogicIDToRemove+"|"+disablingOptionIDToRemove,$optionNode=$dataOptions.find("option[id="+optionID+"]");if(null!=$optionNode){var foundIndex,disablers=$optionNode.attr("disablers");disablers&&(("string"==typeof disablers||disablers instanceof String)&&(disablers=-1!==disablers.indexOf(",")?disablers.split(","):[disablers]),-1!==(foundIndex=disablers.indexOf(disablingSet))&&disablers.splice(foundIndex,1),disablers=typeof disablers==typeof Array?disablers.length>1?disablers.join(","):String(disablers[0]):String(disablers)),void 0===disablers&&(disablers=""),$optionNode.attr("disablers",disablers)}}function optionsLogicProcessOption_DisablersExist(optionID,disablingLogicIDToIgnore,disablingOptionIDToIgnore){var bExists,disablingSet=disablingLogicIDToIgnore+"|"+disablingOptionIDToIgnore,$optionNode=$dataOptions.find("option[id="+optionID+"]");if(null!=$optionNode){var foundIndex,disablers=$optionNode.attr("disablers");return disablers&&disablingLogicIDToIgnore&&disablingOptionIDToIgnore?(("string"==typeof disablers||disablers instanceof String)&&(disablers=-1!==disablers.indexOf(",")?disablers.split(","):[disablers]),-1!==(foundIndex=$.inArray(disablingSet,disablers))&&disablers.splice(foundIndex,1),bExists=disablers.length>0):bExists=void 0!==disablers&&""!==disablers,bExists}}function optionsLogicProcessOption_DisablersClearAll(){$dataOptions.find("option").each((function(){$(this).attr("disablers","")}))}function optionsLogicDbgOption(optionID){var $optionNode=$dataOptions.find("option[id="+optionID+"]");if(null!=$optionNode)return optionID+" ("+$optionNode.attr("displayname")+")"}